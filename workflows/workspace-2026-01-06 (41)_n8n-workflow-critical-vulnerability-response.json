{
  "name": "Critical Vulnerability Response - React2Shell",
  "nodes": [
    {
      "parameters": {},
      "id": "webhook-trigger",
      "name": "Webhook",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 1,
      "position": [
        100,
        200
      ],
      "webhookId": "cve-2025-55182-alert"
    },
    {
      "parameters": {
        "functionCode": "const webhookData = $input.first().json;\n\n// Extract and normalize vulnerability data\nconst vulnerabilityData = {\n  cveId: webhookData.cve_id || 'CVE-2025-55182',\n  severity: 'CRITICAL',\n  cvssScore: 10.0,\n  affectedSoftware: webhookData.affected_systems?.software || ['React 19.x', 'Next.js 15.x/16.x'],\n  exploitationStatus: webhookData.exploitation_status || 'ACTIVE',\n  timestamp: new Date().toISOString()\n};\n\nreturn vulnerabilityData;"
      },
      "id": "extract-vuln-data",
      "name": "Extract Vulnerability Data",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [
        300,
        200
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://otx.alienvault.com/api/v1/indicators/cve/{{ $json.cveId }}",
        "options": {
          "timeout": 10000
        }
      },
      "id": "alienvault-enrichment",
      "name": "AlienVault OTX Enrichment",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 1,
      "position": [
        500,
        100
      ]
    },
    {
      "parameters": {
        "method": "GET",
        "url": "https://services.nvd.nist.gov/rest/json/cves/2.0?cveId={{ $json.cveId }}",
        "options": {
          "timeout": 10000
        }
      },
      "id": "nvd-enrichment",
      "name": "NVD NIST Enrichment",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 1,
      "position": [
        500,
        200
      ]
    },
    {
      "parameters": {
        "method": "GET",
        "url": "https://cisa known-exploited-vulnerabilities-catalog.s3.amazonaws.com/known_exploited_vulnerabilities.json",
        "options": {
          "timeout": 15000
        }
      },
      "id": "cisa-kev-check",
      "name": "CISA KEV Check",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 1,
      "position": [
        500,
        300
      ]
    },
    {
      "parameters": {
        "functionCode": "const vulnData = $input.first().json;\nconst enrichment = $input.all();\n\n// Calculate priority score based on multiple factors\nconst priorityScore = (\n  (vulnData.cvssScore * 0.4) +\n  (vulnData.exploitationStatus === 'ACTIVE_EXPLOITATION' ? 40 : 0) +\n  (enrichment.find(n => n.json.cisa_kev) ? 20 : 0) +\n  (enrichment.find(n => n.json.epss_score > 0.5) ? 15 : 0)\n);\n\nconst priority = priorityScore > 75 ? 'P1' : priorityScore > 50 ? 'P2' : priorityScore > 25 ? 'P3' : 'P4';\n\nreturn {\n  priority,\n  priorityScore: Math.round(priorityScore),\n  processedAt: new Date().toISOString(),\n  sourceData: vulnData,\n  enrichmentData: enrichment.map(e => e.json)\n};"
      },
      "id": "calculate-priority",
      "name": "Calculate Priority Score",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [
        700,
        200
      ]
    },
    {
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{ $json.priority }}",
              "operation": "equal",
              "value2": "P1"
            }
          ]
        }
      },
      "id": "priority-filter",
      "name": "Priority Filter",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [
        900,
        200
      ]
    },
    {
      "parameters": {
        "channel": "security-alerts",
        "text": "=ðŸš¨ **CRITICAL VULNERABILITY ALERT** ðŸš¨\\n\\n**CVE:** {{ $json.sourceData.cveId }}\\n**Severity:** CRITICAL (CVSS: {{ $json.sourceData.cvssScore }})\\n**Status:** ACTIVE EXPLOITATION\\n\\n**Affected Systems:**\\n{{ $json.sourceData.affectedSoftware.join('\\n') }}\\n\\n**Immediate Actions Required:**\\n1. Patch React to 19.0.1+ / Next.js to 15.2.3+ or 16.0.4+\\n2. Block RSC endpoints at WAF level\\n3. Enable enhanced deserialization logging\\n4. Hunt for IOCs in affected environments\\n\\n**Priority Score:** {{ $json.priorityScore }}/100",
        "blocks": []
      },
      "id": "slack-critical-alert",
      "name": "Slack Critical Alert",
      "type": "n8n-nodes-base.slack",
      "typeVersion": 1,
      "position": [
        1100,
        100
      ]
    },
    {
      "parameters": {
        "to": "security-team@company.com",
        "subject": "ðŸš¨ CRITICAL: CVE-2025-55182 React2Shell Active Exploitation - Immediate Action Required",
        "options": {
          "attachments": true
        },
        "text": "=**CRITICAL VULNERABILITY ALERT - IMMEDIATE ACTION REQUIRED**\n\n**CVE ID:** CVE-2025-55182 (React2Shell)\n**Severity:** CRITICAL (CVSS 10.0)\n**Exploitation Status:** ACTIVE - Confirmed exploitation by ransomware operators\n\n**Executive Summary:**\nA critical remote code execution vulnerability in React Server Components is being actively exploited by threat actors, including ransomware groups. The attack-to-encryption timeline is under 60 seconds.\n\n**Affected Systems:**\n- React 19.x with Server Components enabled\n- Next.js 15.x and 16.x with App Router\n- Any application using the RSC \"Flight\" protocol\n\n**Immediate Remediation Steps:**\n\n1. **Emergency Patching (0-4 hours):**\n   - Upgrade React to version 19.0.1 or later\n   - Upgrade Next.js to 15.2.3, 16.0.4, or later\n   \n2. **Temporary Mitigations (if patching delayed):**\n   - Deploy WAF rules to block external access to /_next/data and /_rsc endpoints\n   - Disable React Server Components if not required\n   - Implement strict input validation for serialized data\n   \n3. **Detection and Hunting:**\n   - Monitor for suspicious HTTP requests to RSC endpoints with malformed data\n   - Watch for unexpected process spawning from application runtimes\n   - Review logs for Cobalt Strike beacon deployment\n   \n4. **Incident Response Prep:**\n   - Pre-position incident response team\n   - Ensure backup systems are accessible\n   - Prepare for potential active compromise\n\n**References:**\n- AWS Security Advisory: https://aws.amazon.com/blogs/security/china-nexus-cyber-threat-groups-rapidly-exploit-react2shell-vulnerability-cve-2025-55182/\n- Wiz Security Analysis: https://www.wiz.io/blog/critical-vulnerability-in-react-cve-2025-55182\n- CISA KEV Catalog: Added December 2025\n\n**Next Steps:**\nPlease acknowledge receipt and initiate emergency patching procedures immediately.\n\n---\nGenerated by CyberSentinel Threat Intelligence System"
      },
      "id": "email-critical-alert",
      "name": "Email Critical Alert",
      "type": "n8n-nodes-base.emailReadImap",
      "typeVersion": 1,
      "position": [
        1100,
        200
      ]
    },
    {
      "parameters": {
        "jiraProject": "SEC",
        "issueType": "Bug",
        "summary": "=CRITICAL: CVE-2025-55182 React2Shell - Patching Required",
        "description": "=**CVE-2025-55182 React2Shell Vulnerability - Immediate Patching Required**\n\n**Severity:** CRITICAL\\n**CVSS Score:** 10.0\\n**Status:** Active Exploitation\\n\n**Affected Assets:**\n{{ $json.sourceData.affectedSoftware.join(', ') }}\n\n**Required Actions:**\n1. Apply emergency patches within 24 hours\n2. Verify no active compromise exists\n3. Document remediation steps taken\n4. Report completion to security team\n\n**Business Impact:**\n- Full system compromise possible\n- Ransomware deployment observed\n- Data exfiltration risk: HIGH",
        "priority": 1
      },
      "id": "jira-ticket-creation",
      "name": "Create Jira Ticket",
      "type": "n8n-nodes-base.jira",
      "typeVersion": 1,
      "position": [
        1300,
        200
      ]
    },
    {
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{ $json.priority }}",
              "operation": "notEqual",
              "value2": "P1"
            }
          ]
        }
      },
      "id": "lower-priority-filter",
      "name": "Lower Priority Filter",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [
        900,
        400
      ]
    },
    {
      "parameters": {
        "channel": "security-updates",
        "text": "=âš ï¸ **Vulnerability Alert** âš ï¸\\n\\n**CVE:** {{ $json.sourceData.cveId }}\\n**Severity:** {{ $json.sourceData.cvssScore >= 8 ? 'HIGH' : 'MEDIUM' }}\\n**Priority:** {{ $json.priority }}\\n\\nAdded to vulnerability management queue for scheduled patching.",
        "blocks": []
      },
      "id": "slack-standard-alert",
      "name": "Slack Standard Alert",
      "type": "n8n-nodes-base.slack",
      "typeVersion": 1,
      "position": [
        1100,
        400
      ]
    },
    {
      "parameters": {
        "to": "vuln-management@company.com",
        "subject": "Vulnerability Alert: {{ $json.sourceData.cveId }}",
        "text": "=**Vulnerability Added to Queue:** {{ $json.sourceData.cveId }}\\n\\n**Severity:** {{ $json.sourceData.cvssScore >= 8 ? 'HIGH' : 'MEDIUM' }}\\n**Priority:** {{ $json.priority }}\\n\\nWill be addressed in next patching cycle.",
        "options": {}
      },
      "id": "email-standard-alert",
      "name": "Email Standard Alert",
      "type": "n8n-nodes-base.emailReadImap",
      "typeVersion": 1,
      "position": [
        1100,
        500
      ]
    },
    {
      "parameters": {
        "functionCode": "const vulnData = $input.first().json;\n\n// Create Splunk/ELK query for log hunting\nconst logQuery = {\n  query: `index=security_logs \n    | search cve_id=\"${vulnData.sourceData.cveId}\" \n       OR url=\"/_next/data/*\" \n       OR url=\"/_rsc/*\"\n       OR process_name IN (\"node*\", \"python*\") \n       AND parent_process IN (\"unknown\", \"httpd\", \"nginx\")`,\n  timeRange: \"-24h\",\n  searchName: `IOC_Hunt_${vulnData.sourceData.cveId}`,\n  scheduledTime: new Date().toISOString()\n};\n\nreturn logQuery;"
      },
      "id": "splunk-ioc-hunt",
      "name": "Create IOC Hunt Query",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [
        1500,
        200
      ]
    },
    {
      "parameters": {
        "values": {
          "string": [
            {
              "name": "workflowStatus",
              "value": "completed"
            },
            {
              "name": "alertSent",
              "value": true
            },
            {
              "name": "ticketCreated",
              "value": true
            },
            {
              "name": "iocHuntCreated",
              "value": true
            }
          ]
        }
      },
      "id": "update-status",
      "name": "Update Workflow Status",
      "type": "n8n-nodes-base.set",
      "typeVersion": 1,
      "position": [
        1700,
        200
      ]
    }
  ],
  "connections": {
    "Webhook": {
      "main": [
        [
          {
            "node": "Extract Vulnerability Data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract Vulnerability Data": {
      "main": [
        [
          {
            "node": "AlienVault OTX Enrichment",
            "type": "main",
            "index": 0
          },
          {
            "node": "NVD NIST Enrichment",
            "type": "main",
            "index": 0
          },
          {
            "node": "CISA KEV Check",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AlienVault OTX Enrichment": {
      "main": [
        [
          {
            "node": "Calculate Priority Score",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "NVD NIST Enrichment": {
      "main": [
        [
          {
            "node": "Calculate Priority Score",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "CISA KEV Check": {
      "main": [
        [
          {
            "node": "Calculate Priority Score",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Calculate Priority Score": {
      "main": [
        [
          {
            "node": "Priority Filter",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Priority Filter": {
      "main": [
        [
          {
            "node": "Slack Critical Alert",
            "type": "main",
            "index": 0
          },
          {
            "node": "Email Critical Alert",
            "type": "main",
            "index": 0
          },
          {
            "node": "Create Jira Ticket",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Lower Priority Filter",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Slack Critical Alert": {
      "main": [
        [
          {
            "node": "Create IOC Hunt Query",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create Jira Ticket": {
      "main": [
        [
          {
            "node": "Create IOC Hunt Query",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Lower Priority Filter": {
      "main": [
        [
          {
            "node": "Slack Standard Alert",
            "type": "main",
            "index": 0
          }
        ],
        []
      ]
    },
    "Slack Standard Alert": {
      "main": [
        [
          {
            "node": "Email Standard Alert",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create IOC Hunt Query": {
      "main": [
        [
          {
            "node": "Update Workflow Status",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {
    "executionOrder": "v1"
  },
  "tags": [
    "vulnerability",
    "cve",
    "react",
    "critical",
    "automated-response"
  ],
  "meta": {
    "version": "1.0.0",
    "author": "CyberSentinel",
    "created": "2025-12-27T14:20:00Z",
    "description": "Automated workflow for responding to critical vulnerability alerts including CVE-2025-55182 React2Shell"
  }
}