{
  "n8nWorkflowId": "cybersentinel-ransomware-qilin-002",
  "name": "Qilin Ransomware Attack Response",
  "nodes": [
    {
      "name": "DarkWebMonitor",
      "type": "n8n-nodes-base.httpRequest",
      "parameters": {
        "method": "GET",
        "url": "={{$node['Config'].json[\"darkwebApi\"]}}/qilin/claims",
        "options": {}
      },
      "position": [
        100,
        200
      ]
    },
    {
      "name": "Config",
      "type": "n8n-nodes-base.function",
      "parameters": {
        "functionCode": "return [{\n  json: {\n    darkwebApi: 'https://api.threatintel.example/v1',\n    ransomwareApi: 'https://api.ransomwaretracker.example/v2',\n    alertThreshold: 10\n  }\n}];"
      },
      "position": [
        100,
        100
      ]
    },
    {
      "name": "AnalyzeClaims",
      "type": "n8n-nodes-base.function",
      "parameters": {
        "functionCode": "const claims = items[0].json.claims || [];\nconst criticalSectors = ['healthcare', 'manufacturing', 'critical_infrastructure'];\nconst recentClaims = claims.filter(c => {\n  const claimDate = new Date(c.published);\n  const weekAgo = new Date();\n  weekAgo.setDate(weekAgo.getDate() - 7);\n  return claimDate >= weekAgo;\n});\n\nconst criticalAlerts = recentClaims.filter(c => \n  criticalSectors.includes(c.sector)\n);\n\nreturn [{\n  json: {\n    threatType: 'RANSOMWARE',\n    severity: 'HIGH',\n    actor: 'Qilin',\n    totalClaims: claims.length,\n    recentClaims: recentClaims.length,\n    criticalSectorAlerts: criticalAlerts.length,\n    dataExfiltratedTB: 31200,\n    sectors: [...new Set(claims.map(c => c.sector))],\n    latestCampaign: recentClaims[0] || null\n  }\n}];"
      },
      "position": [
        300,
        200
      ]
    },
    {
      "name": "CheckOrganizationExposure",
      "type": "n8n-nodes-base.httpRequest",
      "parameters": {
        "method": "POST",
        "url": "={{$node['Config'].json[\"ransomwareApi\"]}}/exposure-check",
        "options": {},
        "parameters": {
          "bodyParameters": {
            "parameters": [
              {
                "name": "organizationDomains",
                "value": "={{$node['Config'].json[\"orgDomains\"]}}"
              }
            ]
          }
        }
      },
      "position": [
        500,
        200
      ]
    },
    {
      "name": "SendExecutiveAlert",
      "type": "n8n-nodes-base.email",
      "parameters": {
        "to": "={{$node['Config'].json[\"execEmails\"]}}",
        "subject": "ðŸš¨ URGENT: Qilin Ransomware Campaign - {{$node['AnalyzeClaims'].json[\"recentClaims\"]}} New Victims This Week",
        "body": "=**Threat Intelligence Brief - Qilin Ransomware**\n\n**Classification:** RANSOMWARE | HIGH\n\n**Current Activity:**\n- {{$node['AnalyzeClaims'].json[\"recentClaims\"]}} new victims claimed in past 7 days\n- {{$node['AnalyzeClaims'].json[\"dataExfiltratedTB\"]}} TB data reportedly exfiltrated\n- Sectors targeted: {{$node['AnalyzeClaims'].json[\"sectors\"].join(', ')}}\n\n**Organization Exposure:**\n{{$node['CheckOrganizationExposure'].json[\"exposureStatus\"]}}\n\n**Recommended Immediate Actions:**\n1. Verify backup integrity and offline copies\n2. Review EDR alerts for Qilin IOCs\n3. Audit VPN and RDP access\n4. Enable enhanced logging\n5. Review recent privileged account activity\n\n**IOCs to Block:**\n- Bitcoin wallets: [wallet hashes]\n- C2 domains: [domain list]\n- File hashes: [hash list]"
      },
      "position": [
        700,
        100
      ]
    },
    {
      "name": "UpdateEDR",
      "type": "n8n-nodes-base.crowdstrike",
      "parameters": {
        "action": "createCustomIOC",
        "iocType": "hash",
        "iocValue": "={{$node['Config'].json[\"qilinHashes\"]}}",
        "description": "Qilin Ransomware IOCs - Auto-generated by CyberSentinel"
      },
      "position": [
        700,
        200
      ]
    },
    {
      "name": "CreateIncident",
      "type": "n8n-nodes-base.servicenow",
      "parameters": {
        "shortDescription": "Qilin Ransomware Threat - Enhanced Monitoring Required",
        "description": "=**Threat Actor:** Qilin\n**Classification:** RANSOMWARE | HIGH\n\n**Threat Summary:**\nQilin ransomware group remains highly active with 31,200 TB data exfiltration claimed. Akira represents 34% of observed attacks.\n\n**Recent Activity:**\n{{$node['AnalyzeClaims'].json[\"latestCampaign\"]}}\n\n**Recommended Actions:**\n1. Verify backup systems are isolated and immutable\n2. Deploy enhanced EDR rules for Qilin IOCs\n3. Review and limit RDP/VPN access\n4. Enable MFA for all privileged accounts\n5. Consider network segmentation for critical assets",
        "urgency": 2,
        "impact": 2
      },
      "position": [
        700,
        300
      ]
    }
  ],
  "connections": {
    "Config": {
      "main": [
        [
          "DarkWebMonitor"
        ]
      ]
    },
    "DarkWebMonitor": {
      "main": [
        [
          "AnalyzeClaims"
        ]
      ]
    },
    "AnalyzeClaims": {
      "main": [
        [
          "CheckOrganizationExposure"
        ]
      ]
    },
    "CheckOrganizationExposure": {
      "main": [
        [
          "SendExecutiveAlert"
        ],
        [
          "UpdateEDR"
        ],
        [
          "CreateIncident"
        ]
      ]
    }
  }
}